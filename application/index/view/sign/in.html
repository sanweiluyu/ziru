<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>北京租房_北京租房网_北京租房信息|价格|网站【自如网】</title>
    <meta name="keywords" content="北京租房,北京租房网,北京租房信息,北京租房价格,北京租房信息网,北京租房网站"/>
    <meta name="description" content="高品质北京租房品牌“自如”，旗下“自如友家”“自如寓”两大产品，数万间公寓。自如承诺：3天不满意全额退款！信仰生活的人，迟早与自如相遇！自如是最高品质的北京租房信息|价格|网站。"/>
    <meta http-equiv="cache-control" content="no-cache, must-revalidate">
    <meta content="width=1200, initial-scale=1, maximum-scale=1, user-scalable=1" name="viewport">
    <link rel="stylesheet" type="text/css" href="/static/css/common.css" />
    <script  type="text/javascript" src="/static/js/jquery.min.js"></script>
    <script  type="text/javascript" src="/static/js/z-common.js"></script>
    <script type='text/javascript'>
        var _vds = _vds || [];
        window._vds = _vds;
        (function(){
            _vds.push(['uid', '']);
            _vds.push(['setAccountId', '8da2730aaedd7628']);
            (function() {
                var vds = document.createElement('script');
                vds.type='text/javascript';
                vds.async = true;
                vds.src = ('https:' == document.location.protocol ? 'https://' : 'http://') + 'dn-growing.qbox.me/vds.js';
                var s = document.getElementsByTagName('script')[0];
                s.parentNode.insertBefore(vds, s);
            })();
        })();
    </script>
    <link rel="stylesheet" type="text/css" href="/static/css/zoneStyle.css" />

</head>
<body>
<div class="m-header">
    <div class="m-header_content">
        <a href=""></a>
    </div>
</div>

<div class="m-content">
    <div class="m-content_mid">
        <div class="modal-content logins" id="logins" style="display: block">
            <div class="separator m_icon"></div>

            <div class="control-group">
                <span class="m_icon user"></span>
                <input type="text" name="user_name" id="user_name" placeholder="请输入用户名或手机号或邮箱" class="inp_txt" tabindex="1">
                <p for="user_name" class="invalid" style="display: none;"></p>
            </div>
            <div class="control-group">
                <span class="m_icon pas"></span>
                <input type="password" name="user_pas" id="user_pas" placeholder="请输入6-16位密码" class="inp_txt" tabindex="2">
                <p for="user_pas" class="invalid" style="display: none;"></p>
            </div>

            <div class="control-group " id="captcha_tr" style="display:none;">
                <input type="hidden" id="is_captcha" value="0">


                <div class="clearfix">
                    <input type="text" name="verification" id="verification" placeholder="请输入验证码" class="inp_txt inp_yzm" tabindex="3">
                    <img src="" width="114" height="45" class="cur_pointer captcha_img" id="J-m-img">
                    <span class="m_icon refurbish"></span>
                </div>

                <p for="verification" class="invalid" style="display: none;"></p>
            </div>

            <div class="control-group clearfix">
                <p class="fl checkbox" id="within">
                    <label for="within_a_week">
                        <span class="m_icon" id="J-m-isSeven"></span>
                        <input type="checkbox" id="within_a_week">一周内免登录
                    </label>
                </p>
                <a href="{:url('lose/password')}" class="fr org">忘记密码？</a>
            </div>
            <div class="control-group clearfix">
                <input type="button" value="登 录" class="org_btn" id="login_button">

            </div>

            <div class="control-group clearfix">

            </div>

            <div class="control-group clearfix tc bottom">
                没有账号？现在就 <a href="{:url('Sign/up')}" class="org" id="toSignup">注册</a>
            </div><!--/control-group-->


        </div>
    </div>
</div>

<div id="footer">
    <div class="area">
        <div class="clearfix">
            <div class="glbLeft">
                <dl class="fList">
                    <dt>关于我们</dt>
                    <dd>
                        <a href="">关于自如</a>
                        <a href="">联系自如</a>
                        <a href="">加入自如</a>
                    </dd>
                </dl>
                <dl class="fList">
                    <dt>自如业务</dt>
                    <dd>
                        <a href="">业务体系</a>
                        <a href="">自如产品</a>
                        <a href="">自如服务</a>
                    </dd>
                </dl>
                <dl class="fList">
                    <dt>关注自如</dt>
                    <dd>
                        <a >自如客微信</a>
                        <a >下载app</a>
                    </dd>
                </dl>
            </div><!--/glbLeft-->

            <div class="glbRight">

                <div class="img">
                    <img src="/static/images/zrk_ewm.png">
                    <p>关注自如客微信</p>
                </div>
                <div class="img">
                    <img src="/static/images/app_ewm.png">
                    <p>下载自如app</p>
                </div><!--/img-->
            </div><!--/glbRight-->
        </div><!--/clearfix-->

        <div class="linksFooter">
            <dl class="clearfix">
            </dl>
        </div>

    </div><!--/area-->
</div><!--/footer-->

<script type="text/javascript">
    var oLinksList=$('#linksFooterList');
    var iLinksHeight=oLinksList.outerHeight();
    var iNum = iLinksHeight/47;
    var iN=0;


    setInterval(function(){
        iN++;
        iN = iN%iNum;
        var top = iN*47;
        if(top >= iLinksHeight/2+47){
            oLinksList.css({'margin-top':'0px'});
            iN=0;
        }else{
            oLinksList.animate({'margin-top':-iN*47+'px'},1000);
        }
    },3000);

    //mqz 2016.5.12验证登录
    (function(){
        var username=$('#user_name');
        var usernameInf=username.next();

        var password=$('#user_pas');
        var passwordInf=password.next();

        var picYzmBox=$('#captcha_tr');
        var picYzmInp=$('#verification');
        var picYzmImg=picYzmInp.next();
        var picGetBtn=picYzmImg.next();
        var picYzmInf=picYzmInp.parent().next();

        var isSeven=$('#J-m-isSeven');
        isSeven.attr('data-isSeven','0');

        var oSubmit=$('#login_button');

        var phoneReg = /^1[0-9]{10}$/;
        var emailReg=/^([a-zA-Z0-9_\.\-])+\@(([a-zA-Z0-9\-])+\.)+([a-zA-Z0-9]{2,4})+$/;
        var return_url = "http%3A%2F%2Fsh.ziroom.com%2F";

        //七天登录
        isSeven.click(function(){
            if($(this).hasClass('m_icon_active')){
                $(this).removeClass('m_icon_active');
                $(this).attr('data-isSeven','0');
            }
            else{
                $(this).addClass('m_icon_active');
                $(this).attr('data-isSeven','1');
            }
        });

        //点击更新图片
        picGetBtn.click(function(){
            addImgRequest('#J-m-img');
        });

        oSubmit.click(function(){

            //判断用户输入的是什么
            var json=null;
            if(phoneReg.test(username.val())){
                json={'phone':username.val(),'password':password.val(),'imgId':picYzmImg.attr('data-imgId'),'imgVValue':picYzmInp.val(),'seven':isSeven.attr('data-isSeven')};
            }
            else if(emailReg.test(username.val())){
                json={'email':username.val(),'password':password.val(),'imgId':picYzmImg.attr('data-imgId'),'imgVValue':picYzmInp.val(),'seven':isSeven.attr('data-isSeven')};
            }
            else{
                json={'username':username.val(),'password':password.val(),'imgId':picYzmImg.attr('data-imgId'),'imgVValue':picYzmInp.val(),'seven':isSeven.attr('data-isSeven')};
            }

            json._csrf= 'dHZkYnVVSmoYRQcQHiZyHRVFBRhFGBVZIR1UTzk8MA8NDCBXGhskLg==';
            $.ajax({
                url:"/index.php?r=account%2Flogin%2Flogin",
                type:'POST',
                data:json,
                dataType:'json',
                success:function(data){
                    if(data.status == 'success'){
                        window.location.href='/index.php?r=user/agent&returnUrl='+return_url+'&passport_token='+data.data.token+'&isSeven='+isSeven.attr('data-isSeven');
                    }
                    else{
                        logMessage(data.error_code);
                        if(data.data.etTimes>=5){
                            picYzmBox.css({
                                display:'block'
                            });
                            addImgRequest('#J-m-img');
                        }
                    }
                },
                error:function(){}
            });
        });

        //键盘事件
        $(document).keydown(function(event){
            if(event.keyCode == 13)
            {
                //判断用户输入的是什么
                var json=null;
                if(phoneReg.test(username.val())){
                    json={'phone':username.val(),'password':password.val(),'imgId':picYzmImg.attr('data-imgId'),'imgVValue':picYzmInp.val(),'seven':isSeven.attr('data-isSeven')};
                }
                else if(emailReg.test(username.val())){
                    json={'email':username.val(),'password':password.val(),'imgId':picYzmImg.attr('data-imgId'),'imgVValue':picYzmInp.val(),'seven':isSeven.attr('data-isSeven')};
                }
                else{
                    json={'username':username.val(),'password':password.val(),'imgId':picYzmImg.attr('data-imgId'),'imgVValue':picYzmInp.val(),'seven':isSeven.attr('data-isSeven')};
                }


                $.ajax({
                    url:'/api/index.php?r=user/login',
                    type:'POST',
                    data:json,
                    dataType:'json',
                    success:function(data){
                        if(data.code=='20000'){
                            window.location.href='/index.php?r=user/agent&returnUrl='+return_url+'&passport_token='+data.resp.token+'&isSeven='+isSeven.attr('data-isSeven');
                        }
                        else{
                            logMessage(data.code);
                            if(data.resp.etTimes>=5){
                                picYzmBox.css({
                                    display:'block'
                                });
                                addImgRequest('#J-m-img');
                            }
                        }
                    },
                    error:function(){}
                });
            }

        });

        //提示信息
        function logMessage(str){
            switch(str){
                case '40001':
                    picYzmInf.html('验证码错误');
                    clearInf();
                    picYzmInp.css({display:'inline-block'});
                    break;
                case '40003':
                    passwordInf.html('密码错误');
                    clearInf();
                    passwordInf.css({display:'block'});
                    break;
                case '40004':
                    usernameInf.html('用户不存在');
                    clearInf();
                    usernameInf.css({display:'block'});
                    break;
                case '40006':
                    usernameInf.html('账号被冻结');
                    clearInf();
                    usernameInf.css({display:'block'});
                    break;
                case '40007':
                    usernameInf.html('账号被封禁');
                    clearInf();
                    usernameInf.css({display:'block'});
                    break;
                case '50000':
                    usernameInf.html('未知错误，请稍后重试');
                    clearInf();
                    usernameInf.css({display:'block'});
                    break;
            }
        }

        //清空提示文字
        function clearInf(){
            usernameInf.css({display:'none'});
            passwordInf.css({display:'none'});
            picYzmInf.css({display:'none'});
        }

        //获取图片验证码
        function addImgRequest(imgId){

            var oImg=$(imgId);

            var u=uuid();
            oImg.attr('data-imgId',u);
            oImg.attr('src','//passport.ziroom.com/img/verify/code/v1?imgId='+u);
        }

        //uuid
        function uuid(){
            var str='0123456789abcdef';
            var res='';
            for(var i=0;i<32;i++){
                res+=str.charAt(Math.floor(Math.random()*16));
            }

            return res;
        }
    })();
</script>

</body>
</html>

